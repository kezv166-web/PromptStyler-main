<!DOCTYPE html>
<html>

<head>
    <title>API Test - Anonymous Mode</title>
    <style>
        body {
            font-family: Arial;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }

        .result {
            background: #2a2a2a;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            white-space: pre-wrap;
        }

        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            background: #6366f1;
            color: white;
            border: none;
            border-radius: 6px;
        }

        button:hover {
            background: #5254cc;
        }

        h3 {
            color: #6366f1;
        }

        .success {
            border-left: 4px solid #10b981;
        }

        .error {
            border-left: 4px solid #ef4444;
        }
    </style>
</head>

<body>
    <h1>üîß API Test - Anonymous Mode (credentials: omit)</h1>
    <p>Testing with anonymous requests to avoid deprecation notice:</p>

    <button onclick="testStyle('PROFESSIONAL')">Test PROFESSIONAL</button>
    <button onclick="testStyle('MARKDOWN')">Test MARKDOWN</button>
    <button onclick="testStyle('JSON')">Test JSON</button>
    <button onclick="testStyle('TOON')">Test TOON</button>
    <button onclick="clearResults()">Clear Results</button>

    <div id="results"></div>

    <script>
        const SYSTEM_PROMPT = `You are "PromptStyler". Output ONLY the refined prompt, no explanations.`;

        async function testStyle(style) {
            const resultsDiv = document.getElementById('results');
            const testPrompt = "write a simple hello world program";

            resultsDiv.innerHTML += `<h3>Testing ${style}...</h3>`;

            try {
                const userPrompt = `Style: ${style}\n\nUser Input:\n${testPrompt}`;
                const encodedPrompt = encodeURIComponent(userPrompt);
                const encodedSystem = encodeURIComponent(SYSTEM_PROMPT);

                // Using GET with credentials: 'omit' to make anonymous request
                const url = `https://text.pollinations.ai/${encodedPrompt}?model=openai&system=${encodedSystem}&seed=42`;

                const response = await fetch(url, {
                    method: 'GET',
                    credentials: 'omit'  // This makes the request anonymous
                });

                console.log('Response status:', response.status);

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const result = await response.text();

                console.log('Result:', result);

                resultsDiv.innerHTML += `<div class="result success"><strong>‚úÖ Status:</strong> ${response.status}<br><strong>Response:</strong><br>${escapeHtml(result.trim())}</div>`;
            } catch (error) {
                console.error('Error:', error);
                resultsDiv.innerHTML += `<div class="result error"><strong>‚ùå Error:</strong> ${error.message}</div>`;
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }
    </script>
</body>

</html>